<!doctype html>
<html lang="en">

<head>
  <link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=bsmaklHF" />
  <link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=qtvMKcIJ" />
  <link rel="canonical" href="https://lupyuen.org/articles/create-your-iot-gadget-with-apache-mynewt-and-stm32-blue-pill.html" />
  <!-- End Wayback Rewrite JS Include -->
  <title data-rh="true">Create your IoT gadget with Apache Mynewt and STM32 Blue Pill</title>
  <meta data-rh="true" charset="utf-8" />
  <meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1" />
  <meta data-rh="true" name="theme-color" content="#000000" />
  <meta data-rh="true" property="og:type" content="article" />
  <meta data-rh="true" property="article:published_time" content="2019-08-17T17:19:06.091Z" />
  <meta data-rh="true" name="title" content="Create your IoT gadget with Apache Mynewt and STM32 Blue Pill" />
  <meta data-rh="true" property="og:title" content="Create your IoT gadget with Apache Mynewt and STM32 Blue Pill" />
  <meta data-rh="true" property="twitter:title"
    content="Create your IoT gadget with Apache Mynewt and STM32 Blue Pill" />
  <meta data-rh="true" name="description"
    content="Apache Mynewt is an open-source realtime OS for microcontrollers that supports multitasking sensors" />
  <meta data-rh="true" property="og:description"
    content="Apache Mynewt is an open-source realtime OS for microcontrollers that supports multitasking sensors" />
  <meta data-rh="true" property="twitter:description"
    content="Apache Mynewt is an open-source realtime OS for microcontrollers that supports multitasking sensors" />
  <meta data-rh="true" name="twitter:card" content="summary_large_image" />
  <meta data-rh="true" name="twitter:creator" content="@MisterTechBlog" />
  <meta data-rh="true" name="author" content="Lup Yuen Lee 李立源" />
  <meta data-rh="true" name="robots" content="index,follow" />
  <meta data-rh="true" name="referrer" content="unsafe-url" />
  <meta data-rh="true" name="twitter:label1" value="Reading time" />
  <meta data-rh="true" name="twitter:data1" value="17 min read" />
  <meta property="og:image" 
  content="https://lupyuen.github.io/images/legacy2/i1.png">

  <!-- Begin scripts/rustdoc-header.html: Header for Custom Markdown files processed by rustdoc, like chip8.md -->
<link rel="alternate" type="application/rss+xml" title="RSS Feed for lupyuen" href="/rss.xml" />
<link rel="stylesheet" type="text/css" href="../normalize.css">
<link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle">

<link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle">
<link rel="stylesheet" type="text/css" href="../prism.css">
<script src="../storage.js"></script><noscript>
<link rel="stylesheet" href="../noscript.css"></noscript>
<link rel="shortcut icon" href="../favicon.ico">
<style type="text/css">
    #crate-search {
        background-image: url("../down-arrow.svg");
    }
    a {
        color: #77d;
    }
</style>
<!-- End scripts/rustdoc-header.html -->

</head>

<body>
  <div id="root">
    <div class="a b c">
      <article>
        <section class="cj ck cl cm ak cn ce n co"></section><span class="r"></span>
        <div>
          <div class="cp u cq cr cs ct"></div>
          <section class="cu cv cw cx cy">
            <div class="cz ak">
              <div class="figure da cz ak paragraph-image">

                
                <p><img src="https://lupyuen.github.io/images/legacy2/i1.png" /></p>


         
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div>
                  <div id="8b48" class="dt du dv bk dw b dx dy dz ea eb ec ed">
                    <h1 class="dw b dx ee dv">Create your IoT gadget with Apache Mynewt and STM32 Blue Pill</h1>
                  </div>
                  <div class="ef">
                    <div class="n eg eh ei ej">
                      <div class="o n">
                        <div><a rel="noopener"
                            href="https://lupyuen.github.io">
                            <div class="dd ek el">
                              <div class="bs n em o p cp en eo ep eq er ct"></div>
                              
                            </div>
                          </a></div>
                        <div class="et ak r">
                          <div class="n">
                            <div style="flex:1"><span class="bj b bk bl bm bn r dv q">
                                <div class="eu n o ev"><span class="bj ew ex bl di ey ez fa fb fc dv"><a
                                      class="at au av aw ax ay az ba bb bc fd bf bg bh bi" rel="noopener"
                                      href="https://lupyuen.github.io">Lup
                                      Yuen Lee 李立源</a></span>
                               
                                </div>
                              </span></div>
                          </div><span class="bj b bk bl bm bn r bo bp"><span class="bj ew ex bl di ey ez fa fb fc bo">
                              <div><a class="at au av aw ax ay az ba bb bc fd bf bg bh bi" rel="noopener"
                                  href="https://lupyuen.github.io/articles/create-your-iot-gadget-with-apache-mynewt-and-stm32-blue-pill">
                                  26 Mar 2019</a> <!-- -->·
                                <!-- -->
                                <!-- -->17
                                <!-- --> min read
                              </div>
                            </span></span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <blockquote class="gc gd ge">
                  <p id="32e9" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">The year is 2029. Humans are
                    populating the Moon, starting at <a class="at cg gu gv gw gx" target="_blank" rel="noopener"
                      href="https://lupyuen.github.io/articles/stm32-blue-pill-unit-testing-with-qemu-blue-pill-emulator">Moon
                      Base One</a>. Two Moon Base Operators observe something highly unusual in the crop garden of
                    beautiful red tomatoes…</p>
                  <p id="d404" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">Operator 1: The sprinklers are
                    turning on and off erratically. We have just upgraded all our STM32-BLUEST-PILL <strong
                      class="gi gy">Temperature Sensing Devices</strong> with a <strong class="gi gy">Soil Moisture
                      Sensor</strong>. Are we sure that the Soil Moisture Sensor is reporting the correct values to the
                    IoT System?</p>
                  <p id="7093" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">Operator 2: Yes the soil
                    moisture values are correct. Just that we are <strong class="gi gy">multitasking two
                      sensors</strong> (temperature and soil moisture) so I decided to poll the temperature every minute
                    and the soil moisture every 100 minutes.</p>
                  <p id="a561" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">You see this clever temperature
                    sensing loop in my code? Every time the counter reaches 100, the code polls the soil moisture
                    sensor, waits for the data, then resumes the temperature sensing loop…</p>
                  <p id="6184" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">Operator 1: So we get the soil
                    moisture <strong class="gi gy">every 100 minutes</strong>? That’s absurd! Let’s change the firmware
                    to poll the <strong class="gi gy">temperature every 3 minutes</strong> and the <strong
                      class="gi gy">soil moisture every 5 minutes</strong>!</p>
                  <p id="d283" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">Operator 2: Hmmm OK. I need to
                    make this sensing loop a little more complicated… One counter for 3 minutes and another for 5
                    minutes…</p>
                  <p id="f91a" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">Operator 1: Yesterday we
                    plugged in the <strong class="gi gy">Light Sensor</strong> on all our STM32-BLUEST-PILL devices
                    right? Can we get the light sensor data now?</p>
                  <p id="2ea5" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">Operator 2: OK but I can’t find
                    a <strong class="gi gy">proper software driver</strong> for the Light Sensor. I’ll hack up a simple
                    C function to read the sensor… Done! I have just <strong class="gi gy">flashed all 1,000</strong> of
                    our STM32-BLUEST-PILL devices with the <strong class="gi gy">latest code for Temperature Sensor,
                      Soil Moisture Sensor AND Light Sensor</strong>.</p>
                  <p id="d127" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">Operator 1: WHAT’S HAPPENING
                    !!! Our IoT Dashboards are now <strong class="gi gy">totally blank</strong>! Says here… “Memory
                    Corruption Error: <strong class="gi gy">Invalid pointer in Light Sensor code</strong>, core dumped”…
                    All 1,000 sensors are dead… Our tomatoes are all <strong class="gi gy">EXPLODING IN FLAMES</strong>
                    !!! NOOOOOOO !!!</p>
                </blockquote>
              </div>
            </div>
          </section>
          <hr class="gz ew ha hb hc hd he hf hg hh hi" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <p id="7125" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><strong class="gi gy">Creating an
                    IoT Device is hard</strong>… Do we have the necessary <strong class="gi gy">software
                    drivers</strong> to read data correctly from the connected sensors? If the device is connected to
                  multiple sensors, can we <strong class="gi gy">read multiple sensors concurrently in a safe and
                    reliable way?</strong> Fortunately, <a
                    href="https://mynewt.apache.org/"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">Apache
                      Mynewt</strong></a> can help!</p>
                <p id="29a4" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Apache Mynewt is a <strong
                    class="gi gy">free, open-source realtime operating system</strong> for microcontrollers. It has been
                  compared with FreeRTOS and Zephyr, though <strong class="gi gy">Mynewt is newer</strong> than FreeRTOS
                  and Zephyr.</p>
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i2.jpeg" /></p>

                  <figcaption><p><em>Hardware needed for this tutorial: (1) Blue
                    Pill (2) ST-Link (3) SparkFun BME280 (optional)</em></p></figcaption>
                </div>
                <p id="602f" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Mynewt runs on various
                  microcontrollers like MIPS32, Microchip PIC32, RISC-V. In this article we’ll learn about programming
                  and running Mynewt on the <a
                    href="http://wiki.stm32duino.com/index.php?title=Blue_Pill"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">STM32 Blue
                      Pill</strong></a>, one of the <a
                    href="https://www.aliexpress.com/wholesale?catId=0&amp;initiative_id=SB_20180924131057&amp;SearchText=stm32f103c8t6+development+board"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">cheapest 32-bit microcontroller
                    dev boards</a> available today (<a
                    href="https://www.aliexpress.com/wholesale?catId=0&amp;initiative_id=SB_20180924131057&amp;SearchText=stm32f103c8t6+development+board"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">only $2</a>!)</p>
                <p id="72fd" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">We’ll flash and debug the Blue
                  Pill with the <a
                    href="https://www.st.com/en/development-tools/st-link-v2.html"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">ST Link
                      V2</strong></a> USB adapter. Or a <a
                    href="https://www.aliexpress.com/wholesale?catId=0&amp;initiative_id=SB_20180924134644&amp;SearchText=st-link+v2"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">compatible USB adapter</a>.</p>
                <p id="0391" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><a
                    href="https://www.bosch-sensortec.com/bst/products/all_products/bme280"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong
                      class="gi gy">BME280</strong></a> is a popular sensor for ambient temperature, relative humidity
                  and air pressure. In this tutorial we’ll configure Mynewt to poll the BME280 temperature sensor every
                  10 seconds. So just imagine we’re building a <strong class="gi gy">temperature sensing device</strong>
                  with Blue Pill. <em class="gh">BME280 is not mandatory for this tutorial.</em></p>
                <div class="figure hk hl hm hn ho cz cl cm paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i3.png" /></p>

            
                  <figcaption><p><em>Roadmap of the tutorial</em></p></figcaption>
                </div>
                <p id="59d1" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">This tutorial is packed full of
                  Mynewt goodies but Blue Pill newbies should have no problem following the steps since we’re using
                  <strong class="gi gy">Visual Studio Code</strong>. We’ll learn to…</p>
                <p id="026b" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">1️⃣<strong class="gi gy"> Install
                    Mynewt</strong> and the Sensor Application</p>
                <p id="481b" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">2️⃣ <strong class="gi gy">Build
                    Mynewt </strong>Bootloader and Application</p>
                <p id="d055" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">3️⃣ <strong class="gi gy">Flash
                    Bootloader and Application</strong> to Blue Pill</p>
                <p id="1a94" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">4️⃣ <strong class="gi gy">Debug
                    Mynewt</strong> on Blue Pill</p>
                <p id="3fb2" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">5️⃣ <strong
                    class="gi gy">Configure Mynewt </strong>for BME280 Sensor</p>
                <p id="ee99" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">6️⃣ <strong class="gi gy">View
                    Mynewt debug messages</strong></p>
                <p id="9ed1" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">7️⃣ <strong
                    class="gi gy">Customise Mynewt</strong> with a custom debug console</p>
                <p id="ba57" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">8️⃣ <strong class="gi gy">Manage
                    Mynewt Package Dependencies</strong></p>
                <p id="60b7" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">9️⃣ <strong class="gi gy">Target
                    Mynewt</strong> for multiple microcontrollers</p>
              </div>
            </div>
          </section>
          <hr class="gz ew ha hb hc hd he hf hg hh hi" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <h1 id="d785" class="ii ij dv bk bj ik il im in io ip iq ir is it iu iv">Install Visual Studio Code and
                  the Mynewt Sensor Application</h1>
                <p id="1fba" class="gf gg dv bk gi b gj iw gl ix gn iy gp iz gr ja gt"><em class="gh">Follow these
                    instructions if you’re using Windows or macOS</em></p>
                <blockquote class="gc gd ge">
                  <p id="10aa" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">► <a
                      href="https://youtu.be/uevCLrzLANk"
                      class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">Watch the video</a></p>
                </blockquote>
                <p id="f9a1" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">1️⃣ Install <strong
                    class="gi gy">Visual Studio Code</strong> for Windows or macOS<strong class="gi gy">
                  </strong>from<br />► <a
                    href="https://code.visualstudio.com/"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">Visual
                      Studio Code Website</strong></a></p>
                <p id="212c" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Launch Visual Studio Code</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">

                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>


                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">

                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i4.png" /></p>


            
                </div>
                <p id="17e6" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">2️⃣ Click <br /><code
                    class="dm jp jq jr js b"><strong class="gi gy">View → Command Palette</strong></code></p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">

                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>


                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">

                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i5.png" /></p>


                </div>
                <p id="281d" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">3️⃣ After <code
                    class="dm jp jq jr js b">&gt;</code>, type <br /><code
                    class="dm jp jq jr js b"><strong class="gi gy">git clone</strong></code> <br />Press Enter</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">

                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>


               
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">

                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i6.png" /></p>


                
                </div>
                <p id="4fcd" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">4️⃣ For <code
                    class="dm jp jq jr js b"><strong class="gi gy">Repository URL</strong></code>, enter</p>
                <p id="37f0" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><code
                    class="dm jp jq jr js b"><strong class="gi gy">https://github.com/lupyuen/stm32bluepill-mynewt-sensor</strong></code>
                </p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                

                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>


                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i7.png" /></p>
  
  
              
                </div>
                <p id="27a5" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">5️⃣ <em class="gh">For
                    Windows:</em> Select your <br /><code
                    class="dm jp jq jr js b"><strong class="gi gy">Local Disk C:</strong></code> drive</p>
                <p id="1fcd" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><em class="gh">For macOS:</em>
                  Select your <strong class="gi gy">Home folder</strong></p>
                <p id="cdcd" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">The Mynewt Sensor Application
                  source code will be downloaded to <code
                    class="dm jp jq jr js b"><strong class="gi gy">C:\stm32bluepill-mynewt-sensor</strong></code>
                  (Windows) or <code
                    class="dm jp jq jr js b"><strong class="gi gy">$HOME/stm32bluepill-mynewt-sensor</strong></code>
                  (macOS)</p>
                <p id="3994" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">In the Windows Ubuntu
                  environment, this folder is accessed via the path <code
                    class="dm jp jq jr js b"><strong class="gi gy">/mnt/c/stm32bluepill-mynewt-sensor</strong></code>
                </p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                  
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i8.png" /></p>
  
  
                </div>
                <p id="47e0" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">6️⃣ When prompted, click
                  <br /><code class="dm jp jq jr js b"><strong class="gi gy">Open Repository</strong></code><strong
                    class="gi gy">. </strong>If the prompt disappears before clicking, click the bell icon at lower
                  right</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                 
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i9.png" /></p>
  
  
                </div>
                <p id="9ed7" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">7️⃣ When prompted, click
                  <br /><code class="dm jp jq jr js b"><strong class="gi gy">Open Workspace</strong></code></p>
                <p id="7f4f" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">If the prompt disappears before
                  clicking, click the bell icon at lower right</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                 
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <p id="b551" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">8️⃣ Edit the configuration file
                  <code
                    class="dm jp jq jr js b"><a href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/targets/bluepill_my_sensor/syscfg.yml" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">targets/bluepill_my_sensor/syscfg.yml</a>.</code>
                  Update the settings so that <code class="dm jp jq jr js b">TUTORIAL1</code> is uncommented and <code
                    class="dm jp jq jr js b">TUTORIAL2</code> is commented out, like this…</p>
                <pre
                  class="hk hl hm hn ho kd ke kf"><span id="573b" class="kg ij dv bk js b ex kh ki r kj">TUTORIAL1:              1  # Uncomment Tutorial 1   </span><span id="c028" class="kg ij dv bk js b ex kk kl km kn ko ki r kj">#TUTORIAL2:             1  # Comment out Tutorial 2</span></pre>
              </div>
            </div>
          </section>
          <hr class="gz ew ha hb hc hd he hf hg hh hi" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <h1 id="ad0a" class="ii ij dv bk bj ik il im in io ip iq ir is it iu iv">Install Apache Mynewt for
                  Windows</h1>
                <p id="b4d8" class="gf gg dv bk gi b gj iw gl ix gn iy gp iz gr ja gt"><em class="gh">Skip this section
                    if you’re NOT using Windows. For Ubuntu Linux, </em><a
                    href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor#install-apache-mynewt-for-ubuntu-linux"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><em class="gh">refer to these
                      instructions</em></a><em class="gh">.</em></p>
                <blockquote class="gc gd ge">
                  <p id="e910" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">► <a
                      href="https://youtu.be/uevCLrzLANk?t=103"
                      class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">Watch the video</a></p>
                </blockquote>
                <p id="02eb" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">1️⃣ <a
                    href="https://docs.microsoft.com/en-us/windows/wsl/install-win10"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">Follow the instructions in this
                    article</a> to install <strong class="gi gy">Windows Subsystem for Linux.</strong></p>
                <div class="figure hk hl hm hn ho cz cl cm paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>


                
                </div>
                <div class="figure id cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i10.png" /></p>
  
  
                 
                </div>
                <p id="d58a" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">The PowerShell command in the
                  article should be run as <strong class="gi gy">Administrator</strong>…</p>
                <p id="d80f" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Right-click <code
                    class="dm jp jq jr js b"><strong class="gi gy">Windows PowerShell</strong></code> in the Windows
                  menu</p>
                <p id="656d" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Select <code
                    class="dm jp jq jr js b"><strong class="gi gy">Run As Administrator</strong></code></p>
                <div class="figure hk hl hm hn ho cz cl cm paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>


                </div>
                <div class="figure id cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i11.png" /></p>
  
  
                
                </div>
                <p id="b98f" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">For the <code
                    class="dm jp jq jr js b"><strong class="gi gy">Linux Distribution,<br/></strong></code>select <code
                    class="dm jp jq jr js b"><strong class="gi gy">Ubuntu</strong></code></p>
                <p id="51ab" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Click <code
                    class="dm jp jq jr js b"><strong class="gi gy">Get</strong></code></p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i12.png" /></p>
  
  
                
                </div>
                <p id="139f" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">2️⃣ Click <code
                    class="dm jp jq jr js b"><strong class="gi gy">Windows → Ubuntu</strong></code></p>
                <p id="94b9" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">When prompted, enter a simple
                  user ID (e.g. <code class="dm jp jq jr js b">user</code>) <strong class="gi gy">without any
                    spaces</strong>.</p>
                <p id="88b6" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Enter a password of your choice.
                </p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
               
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i13.png" /></p>
  
  
           
                </div>
                <p id="fbe6" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">3️⃣ Switch over to Visual Studio
                  Code.</p>
                <p id="a046" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Click <code
                    class="dm jp jq jr js b"><strong class="gi gy">Terminal → Run Task</strong></code></p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
          
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i14.png" /></p>
  
  
                
                </div>
                <p id="94e1" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">4️⃣ Select <br /><code
                    class="dm jp jq jr js b"><strong class="gi gy">[0] Install Apache Mynewt</strong></code></p>
                <p id="616d" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">When prompted, click <code
                    class="dm jp jq jr js b"><strong class="gi gy">Continue Without Scanning The Task Output</strong></code>
                </p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
              
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i15.png" /></p>
  
  
              
                </div>
                <p id="a88f" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">5️⃣ When prompted, click on the
                  <code class="dm jp jq jr js b"><strong class="gi gy">Terminal</strong></code> pane and enter the
                  password from Step 2️⃣</p>
                <p id="9c4d" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">The password only needs to be
                  entered once.</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                  
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i16.png" /></p>
  
  
             
                </div>
                <p id="e140" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">6️⃣ The <a
                    href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/scripts/install-windows.sh"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">setup script</a> will take a few
                  minutes to download and install the build tools.</p>
                <p id="6bf2" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">When it’s done, we should see
                  <code class="dm jp jq jr js b"><strong class="gi gy">Done!</strong></code></p>
                <p id="d50f" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><strong class="gi gy">Exit and
                    restart Visual Studio Code</strong>. This activates the <a
                    href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/scripts/install-ext-windows.cmd"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">installed extensions</a>.</p>
                <p id="6707" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">In case of problems, compare your
                  log with <a
                    href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/logs/install-windows.log"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">this setup log</a>.</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <p id="5d5f" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">7️⃣ Download the <strong
                    class="gi gy">ST-Link USB driver</strong> from<br />► <a
                    href="http://www.st.com/en/embedded-software/stsw-link009.html"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">ST-Link
                      Driver Website</strong></a> (email registration required)<br />Click <code
                    class="dm jp jq jr js b">Get Software</code></p>
                <p id="ebca" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Unzip the downloaded file.
                  Double-click the driver installer: <br /><code class="dm jp jq jr js b">dpinst_amd64.exe</code></p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <p id="1f29" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">8️⃣ Install <strong
                    class="gi gy">Arm Cross-Compiler and Linker for Windows </strong>from<br />► <a
                    href="https://developer.arm.com/open-source/gnu-toolchain/gnu-rm/downloads"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">Arm
                      Developer Website</strong></a></p>
                <div class="figure hk hl hm hn ho cz cl cm paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i17.png" /></p>
  
  
            
                </div>
                <p id="87ae" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Look for the first <strong
                    class="gi gy">Windows 32-bit Download without SHA</strong>, e.g.<strong class="gi gy">
                    <br /></strong><code
                    class="dm jp jq jr js b">gcc-arm-none-eabi-...-major-<strong class="gi gy">win32.exe</strong></code><strong
                    class="gi gy"><br /></strong>Click<strong class="gi gy"> </strong><code
                    class="dm jp jq jr js b"><strong class="gi gy">Download</strong></code></p>
                <p id="471c" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Select this option at the last
                  install step: <br /><code class="dm jp jq jr js b">&quot;Add path to environment variable&quot;</code>
                </p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                  
                  </div>
                </div>
              </div>
            </div>
          </section>
          <hr class="gz ew ha hb hc hd he hf hg hh hi" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <h1 id="b9c8" class="ii ij dv bk bj ik il im in io ip iq ir is it iu iv">Install Apache Mynewt for macOS
                </h1>
                <p id="6fb5" class="gf gg dv bk gi b gj iw gl ix gn iy gp iz gr ja gt"><em class="gh">Skip this section
                    if you’re NOT using macOS</em></p>
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i18.png" /></p>
  
  
             
                </div>
                <p id="21c4" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">1️⃣ Switch over to Visual Studio
                  Code.</p>
                <p id="dd9a" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Click <code
                    class="dm jp jq jr js b"><strong class="gi gy">Terminal → Run Task</strong></code></p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i19.png" /></p>
  
  
            
                </div>
                <p id="6e82" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">2️⃣ Select <br /><code
                    class="dm jp jq jr js b"><strong class="gi gy">[0] Install Apache Mynewt</strong></code></p>
                <p id="3b10" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">When prompted, click <code
                    class="dm jp jq jr js b"><strong class="gi gy">Continue Without Scanning The Task Output</strong></code>
                </p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                   
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i20.png" /></p>
  
  
                </div>
                <p id="ca81" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">3️⃣ When prompted, click on the
                  <code class="dm jp jq jr js b"><strong class="gi gy">Terminal</strong></code> pane and enter your
                  macOS password</p>
                <p id="acff" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">The password only needs to be
                  entered once.</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                    
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i21.png" /></p>
  
  
              
                </div>
                <p id="3b40" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">4️⃣ The <a
                    href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/scripts/install-mac.sh"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">setup script</a> will take a few
                  minutes to download and install the build tools.</p>
                <p id="2dfc" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">When it’s done, we should see
                  <code class="dm jp jq jr js b"><strong class="gi gy">Done!</strong></code></p>
                <p id="94ea" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><strong class="gi gy">Exit and
                    restart Visual Studio Code</strong>. This activates the <a
                    href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/scripts/install-ext-windows.cmd"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">installed extensions</a>.</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                  </div>
                </div>
              </div>
            </div>
          </section>
          <hr class="gz ew ha hb hc hd he hf hg hh hi" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <h1 id="f15b" class="ii ij dv bk bj ik il im in io ip iq ir is it iu iv">Build Mynewt Bootloader and
                  Application</h1>
                <p id="2ad1" class="gf gg dv bk gi b gj iw gl ix gn iy gp iz gr ja gt">We’ll now build the Mynewt
                  Bootloader and Application that will be flashed to the Blue Pill ROM…</p>
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i22.png" /></p>
  
  
                </div>
                <p id="cd66" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">1️⃣ Click <br /><code
                    class="dm jp jq jr js b"><strong class="gi gy">Terminal → Run Task → <br/>[1] Build bluepill_boot</strong></code>
                </p>
                <blockquote class="gc gd ge">
                  <p id="fca2" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">► <a
                      href="https://youtu.be/LWJIAOFQBe0"
                      class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">Watch the video</a></p>
                </blockquote>
                <p id="7672" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">This builds the <strong
                    class="gi gy">Mynewt Bootloader</strong>, which is run first whenever the Blue Pill is restarted.
                </p>
                <p id="0f6e" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">When the Bootloader Build has
                  completed successfully, we should see <code
                    class="dm jp jq jr js b"><strong class="gi gy">Done!</strong></code></p>
                <p id="0771" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><em class="gh">Note: If we’re
                    building for the first time, it may fail with a missing file error. Click the build command again to
                    complete the build.</em></p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i23.png" /></p>
  
  
                
                </div>
                <p id="64f8" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">2️⃣ Click <br /><code
                    class="dm jp jq jr js b"><strong class="gi gy">Terminal → Run Task → <br/>[2] Build bluepill_my_sensor</strong></code>
                </p>
                <blockquote class="gc gd ge">
                  <p id="cd3d" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">► <a
                      href="https://youtu.be/8naNVsLzlic"
                      class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">Watch the video</a></p>
                </blockquote>
                <p id="73f1" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">This builds the <strong
                    class="gi gy">Mynewt Sensor Application</strong>, which is loaded by the Bootloader whenever the
                  Blue Pill is restarted.</p>
                <p id="f151" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">When the Application Build has
                  completed successfully, we should see <code
                    class="dm jp jq jr js b"><strong class="gi gy">Done!</strong></code></p>
                <p id="a5c6" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><em class="gh">Note: If we’re
                    building for the first time, it may fail with a missing file error. Click the build command again to
                    complete the build.</em></p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                  </div>
                </div>
              </div>
            </div>
          </section>
          <hr class="gz ew ha hb hc hd he hf hg hh hi" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <h1 id="2e64" class="ii ij dv bk bj ik il im in io ip iq ir is it iu iv">Create Application Image</h1>
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i24.png" /></p>
  
  
              
                  <figcaption><p><em>Memory Sections in the Application. From
                    bin/targets/bluepill_my_sensor/app/apps/my_sensor_app/my_sensor_app.elf.lst</em></p></figcaption>
                </div>
                <p id="ffdc" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Remember that Mynewt requires
                  <strong class="gi gy">two programs</strong> to be flashed into the Blue Pill ROM: the <strong
                    class="gi gy">Bootloader</strong> and our <strong class="gi gy">Application</strong>. How does the
                  Bootloader discover which Application has been flashed into the ROM? That’s done through the <a
                    href="https://mynewt.apache.org/latest/os/modules/bootloader/bootloader.html"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">Image
                      Header</strong></a>.</p>
                <p id="c0d5" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">The Image Header is located at
                  the start of the Application and describes the Application (size, security options, …) to the
                  Bootloader. The Image Header is initially blank when we built it above with <code
                    class="dm jp jq jr js b"><strong class="gi gy">Build bluepill_my_sensor</strong></code>. To populate
                  the Image Header, we need to run…</p>
                <p id="7aed" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><code
                    class="dm jp jq jr js b"><strong class="gi gy">Terminal → Run Task → <br/>[3] Image bluepill_my_sensor</strong></code>
                </p>
                <blockquote class="gc gd ge">
                  <p id="c36d" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">► <a
                      href="https://youtu.be/NU8CnHkOudM"
                      class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">Watch the video</a></p>
                </blockquote>
                <p id="10b8" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">This creates an Application ROM
                  image file <code class="dm jp jq jr js b"><strong class="gi gy">my_sensor_app.img</strong></code> that
                  we’ll flash to the Blue Pill in the next step.</p>
              </div>
            </div>
          </section>
          <hr class="gz ew ha hb hc hd he hf hg hh hi" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <h1 id="c101" class="ii ij dv bk bj ik il im in io ip iq ir is it iu iv">Flash Bootloader and
                  Application to Blue Pill</h1>
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i25.png" /></p>
  
  
                  
                  <figcaption><p><em>Connecting Blue Pill to ST-Link USB Debugger
                  </em></p></figcaption>
                </div>
                <p id="063d" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">1️⃣ Connect the Blue Pill and ST
                  Link to the USB port of your computer.</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i26.png" /></p>
  
  
                  <figcaption><p><em>Both jumpers should be set to the “0”
                    positions</em></p></figcaption>
                </div>
                <p id="0c43" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">2️⃣ Set both yellow jumpers on
                  the Blue Pill (<code class="dm jp jq jr js b"><strong class="gi gy">BOOT0</strong></code><strong
                    class="gi gy"> </strong>and<code
                    class="dm jp jq jr js b"><strong class="gi gy">BOOT1</strong></code><strong class="gi gy">
                  </strong>near the Micro USB Port) to the <strong class="gi gy">“</strong><code
                    class="dm jp jq jr js b"><strong class="gi gy">0</strong></code><strong class="gi gy">”
                  </strong>positions (closer to the Micro USB Port).</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
  
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <p id="d47c" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">3️⃣ The Bootloader is the first
                  program that Blue Pill runs when powered up, so it needs to be flashed first. To flash the Bootloader
                  into the Blue Pill ROM, click…</p>
                <p id="d5a1" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><code
                    class="dm jp jq jr js b"><strong class="gi gy">Terminal → Run Task → <br/>[4] Load bluepill_boot</strong></code>
                </p>
                <blockquote class="gc gd ge">
                  <p id="3e30" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">► <a
                      href="https://youtu.be/ndGlxmj4N6o"
                      class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">Watch the video</a></p>
                </blockquote>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>
  
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <p id="ee79" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">4️⃣ Next we flash the Application
                  into the Blue Pill ROM, using the Application image we have created in the previous step…</p>
                <p id="4c36" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><code
                    class="dm jp jq jr js b"><strong class="gi gy">Terminal → Run Task → <br/>[5] Load bluepill_my_sensor</strong></code>
                </p>
                <blockquote class="gc gd ge">
                  <p id="9d62" class="gf gg dv gh gi b gj gk gl gm gn go gp gq gr gs gt">► <a
                      href="https://youtu.be/5o4ff3fn-8Y"
                      class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">Watch the video</a></p>
                </blockquote>
              </div>
            </div>
          </section>
          <hr class="gz ew ha hb hc hd he hf hg hh hi" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <h1 id="03f4" class="ii ij dv bk bj ik il im in io ip iq ir is it iu iv">Debug Mynewt on Blue Pill</h1>
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i27.png" /></p>
  
  
                </div>
                <p id="4209" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">We’re all set to execute and
                  debug our Application!</p>
                <p id="306e" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Click <code
                    class="dm jp jq jr js b"><strong class="gi gy">Debug → Start Debugging</strong></code></p>
                <p id="a491" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">This starts the <a
                    href="https://marcelball.ca/projects/cortex-debug/"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">debugger</a> to let us inspect our
                  Application as it runs on Blue Pill.</p>
                <div class="figure hk hl hm hn ho cz cl cm paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>


                </div>
                <div class="figure id cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i28.png" /></p>
  
  
               
                </div>
                <p id="affd" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">The debugger pauses at the line
                  with <code class="dm jp jq jr js b">LoopCopyDataInit</code></p>
                <p id="a990" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Click <code
                    class="dm jp jq jr js b"><strong class="gi gy">Continue</strong></code> or press <code
                    class="dm jp jq jr js b"><strong class="gi gy">F5</strong></code></p>
                <div class="figure hk hl hm hn ho cz cl cm paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>


             
                </div>
                <p id="d3df" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">The debugger pauses next at the
                  <code
                    class="dm jp jq jr js b"><a href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/apps/my_sensor_app/src/main.c#L67-L89" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">main()</a></code><a
                    href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/apps/my_sensor_app/src/main.c#L67-L89"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"> function in </a><code
                    class="dm jp jq jr js b"><a href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/apps/my_sensor_app/src/main.c#L67-L89" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">apps/my_sensor_app/src/main.c</a></code>,
                  so that we may step through the execution…</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/i29.png" /></p>
    
    
                    <figcaption><p><em>Debugging Mynewt Application on Blue Pill
                    </em></p></figcaption>
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <div class="figure hk hl hm hn ho cz cl cm paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>


                </div>
                <p id="05c1" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">What will <a
                    href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/apps/my_sensor_app/src/main.c#L13-L47"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">this Application</a> do?</p>
                <p id="6f32" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">1️⃣ <code
                    class="dm jp jq jr js b"><strong class="gi gy">sysinit()</strong></code>: The Application <strong
                    class="gi gy">initialises the BME280 driver</strong>, which is part of the Mynewt OS. Mynewt has <a
                    href="https://github.com/apache/mynewt-core/blob/master/hw/sensor/creator/src/sensor_creator.c"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">built-in drivers for many
                    sensors</a>, and we may <a
                    href="https://mynewt.apache.org/latest/os/modules/sensor_framework/sensor_framework.html"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">create our own drivers</a> too.
                </p>
                <p id="dd2f" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><code
                    class="dm jp jq jr js b">start_network_task()</code> will only be used in <a
                    class="at cg gu gv gw gx" target="_blank" rel="noopener"
                    href="https://lupyuen.github.io/articles/connect-stm32-blue-pill-to-esp8266-with-apache-mynewt">the
                    next tutorial</a>, so let’s skip to <code
                    class="dm jp jq jr js b"><a href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/apps/my_sensor_app/src/listen_sensor.c#L33-L50" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">start_sensor_listener</strong></a><strong class="gi gy">()</strong></code>
                  in <code
                    class="dm jp jq jr js b"><a href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/apps/my_sensor_app/src/listen_sensor.c" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">apps/my_sensor_app/src/listen_sensor.c</a></code>...
                </p>
                <div class="figure hk hl hm hn ho cz">

                  <p><script src="https://gist.github.com/lupyuen/639cff8965b12dfa40a7fc7117e809a9.js"></script></p>


                  <figcaption><p><em>From <a
                      href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/apps/my_sensor_app/src/listen_sensor.c#L26-L50"
                      class="at cg gu gv gw gx" target="_blank"
                      rel="noopener nofollow">https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/apps/my_sensor_app/src/listen_sensor.c#L26-L50</a>
                  </em></p></figcaption>
                </div>
                <p id="946a" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">2️⃣ <code
                    class="dm jp jq jr js b"><a href="https://mynewt.apache.org/latest/os/modules/sensor_framework/sensor_mgr_api.html#c.sensor_set_poll_rate_ms" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">sensor_set_poll_rate_ms</strong></a><strong class="gi gy">()</strong></code>:
                  We’ll instruct the Mynewt OS to <strong class="gi gy">poll the BME280 sensor every 10
                    seconds</strong>. Mynewt is a realtime OS so we can trust it to poll multiple sensors concurrently
                  without risk of data corruption. Which is highly critical for IoT devices!</p>
                <p id="d878" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">3️⃣ <code
                    class="dm jp jq jr js b"><a href="https://mynewt.apache.org/latest/os/modules/sensor_framework/sensor_mgr_api.html#c.sensor_mgr_find_next_bydevname" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">sensor_mgr_find_next_bydevname</strong></a><strong class="gi gy">()</strong></code>:
                  We’ll call the Mynewt Sensor Manager to <strong class="gi gy">fetch the object that represents our
                    BME280 sensor</strong>. Each sensor is identified by a name assigned by Mynewt. The sensor name
                  looks like this: <code class="dm jp jq jr js b">bme280_0</code>.</p>
                <p id="5c77" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">4️⃣ <code
                    class="dm jp jq jr js b"><a href="https://mynewt.apache.org/latest/os/modules/sensor_framework/sensor_listener_api.html#c.sensor_register_listener" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">sensor_register_listener</strong></a><strong class="gi gy">()</strong></code>:
                  What happens after Mynewt has polled our BME280 sensor? We instruct Mynewt to call <a
                    href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/apps/my_sensor_app/src/listen_sensor.c#L52-L84"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">our listener
                      function </strong></a><code
                    class="dm jp jq jr js b"><a href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/apps/my_sensor_app/src/listen_sensor.c#L52-L84" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">read_temperature</strong></a><strong class="gi gy">()</strong></code>.
                  In this demo we’ll just display the temperature on the console…</p>
                <div class="figure hk hl hm hn ho cz">

                  <p><script src="https://gist.github.com/lupyuen/94e1526263700b16ede9ad567cd88626.js"></script></p>


                </div>
                <p id="166e" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">And back to <code
                    class="dm jp jq jr js b"><a href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/apps/my_sensor_app/src/main.c#L67-L89" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">apps/my_sensor_app/src/main.c</a></code>...
                </p>
                <p id="582b" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">5️⃣ <code
                    class="dm jp jq jr js b"><a href="https://mynewt.apache.org/latest/os/core_os/event_queue/event_queue.html#c.os_eventq_run" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">os_eventq_run</strong></a><strong class="gi gy">()</strong></code>:
                  Finally we let Mynewt <strong class="gi gy">start multitasking</strong>. This is the standard Event
                  Queue loop that’s required for all Mynewt applications. It will start polling our BME280 sensor and
                  calling our listener function every 10 seconds.</p>
                <p id="a178" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">With a few lines of code we have
                  created a working IoT sensor device that can handle multiple sensors with multitasking! Let’s verify
                  that it really works…</p>
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i30.png" /></p>
  
  
                
                </div>
                <p id="a40c" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">In the <a
                    href="https://code.visualstudio.com/docs/editor/debugging"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">debugger toolbar</a>, click the
                  <strong class="gi gy">Step Over</strong> button (the second button).</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/i31.png" /></p>
    
    
                   
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <p id="2cb3" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">The debugger has paused at <code
                    class="dm jp jq jr js b"><a href="https://github.com/apache/mynewt-core/blob/master/kernel/os/src/arch/arc/os_fault.c#L127-L148" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">__assert_func()</a></code>,
                  which means that Mynewt has encountered a fatal error (assertion failure). Let’s check what went
                  wrong.</p>
                <p id="b488" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">In the Call Stack, click on <code
                    class="dm jp jq jr js b"><strong class="gi gy">sensor_dev_create()</strong></code>. This the culprit
                  function that triggered the failure…</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/i32.png" /></p>
    
    
                  </div>
                </div>
              </div>
            </div>
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <p id="d8f2" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Mynewt is attempting to
                  initialise the BME280 driver but it failed. Which could happen if we didn’t connect a real BME280
                  sensor to our Blue Pill. But it could also happen if our <strong class="gi gy">BME280 sensor is
                    misconfigured</strong>…</p>
              </div>
            </div>
          </section>
          <hr class="gz ew ha hb hc hd he hf hg hh hi" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <h1 id="e267" class="ii ij dv bk bj ik il im in io ip iq ir is it iu iv">Configure Mynewt for BME280
                  Sensor</h1>
                <p id="7b34" class="gf gg dv bk gi b gj iw gl ix gn iy gp iz gr ja gt">This code in the screen above is
                  from the <a
                    href="https://github.com/apache/mynewt-core/blob/master/hw/sensor/creator/src/sensor_creator.c#L1208-L1215"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">Mynewt
                      Sensor Creator</strong></a>. One amazing feature of Mynewt is that <em class="gh">we don’t need to
                    write any code to configure common sensors</em> like BME280. How do we tell Mynewt that we have
                  connected a BME280 sensor? Though the <code
                    class="dm jp jq jr js b"><a href="https://mynewt.apache.org/latest/os/modules/sysinitconfig/sysinitconfig.html" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">syscfg.yml</strong></a></code><a
                    href="https://mynewt.apache.org/latest/os/modules/sysinitconfig/sysinitconfig.html"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy"> System
                      Configuration File</strong></a>!</p>
                <p id="7922" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Here’s the System Configuration
                  File for our Application, located at <code
                    class="dm jp jq jr js b"><a href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/apps/my_sensor_app/syscfg.yml" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">apps/my_sensor_app/syscfg.yml</a></code>...
                </p>
                <pre
                  class="hk hl hm hn ho kd ke kf"><span id="5608" class="kg ij dv bk js b ex kh ki r kj">syscfg.vals.TUTORIAL1:<br/>    BME280_OFB:   1  # Enable BME280 offboard sensor<br/>    SPI_0_MASTER: 1  # Enable port SPI1 for BME280</span></pre>
                <p id="af8d" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><code
                    class="dm jp jq jr js b">BME280_OFB</code> causes the Sensor Creator to <strong
                    class="gi gy">include the BME280 driver</strong> in our Application. (<code
                    class="dm jp jq jr js b">OFB</code> means it’s an off-board sensor, i.e. it’s not a sensor that’s
                  integrated with the Blue Pill microcontroller)</p>
                <p id="7e11" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><code
                    class="dm jp jq jr js b">SPI_0_MASTER</code> tells the Sensor Creator to <strong class="gi gy">use
                    the first SPI port</strong> (SPI1) on Blue Pill. Connecting the Application to the BME280 sensor via
                  SPI is really that easy!</p>
                <div class="figure hk hl hm hn ho cz cl cm paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i33.png" /></p>
  
  
               
                  <figcaption><p><em>Connecting BME280 to Blue Pill. From <a
                      href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/bme280spi.fzz"
                      class="at cg gu gv gw gx" target="_blank"
                      rel="noopener nofollow">https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/bme280spi.fzz</a>
                  </em></p></figcaption>
                </div>
                <pre
                  class="hk hl hm hn ho kd ke kf"><span id="7c2d" class="kg ij dv bk js b ex kh ki r kj"><strong class="js gy">Blue Pill Pin PA4  (SS1)   → BME280 Pin !CS</strong><br/>Blue Pill Pin PA5  (SCK1)  → BME280 Pin SCK<br/>Blue Pill Pin PA6  (MISO1) → BME280 Pin SDO<br/>Blue Pill Pin PA7  (MOSI1) → BME280 Pin SDI<br/>Blue Pill Pin 3V3          → BME280 Pin 3.3V<br/>Blue Pill Pin GND          → BME280 Pin GND</span></pre>
                <p id="3d70" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">That’s how we normally wire up
                  the BME280 sensor to Blue Pill on port SPI1. Note that the <strong class="gi gy">CS (Chip Select) Pin
                    is connected to PA4</strong> on Blue Pill. There’s a slight complication… If you look at the <a
                    href="https://github.com/apache/mynewt-core/blob/master/hw/sensor/creator/src/sensor_creator.c#L200-L206"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">Sensor Creator code,</a> it
                  assumes that the <strong class="gi gy">CS Pin is connected to PA3</strong>…</p>
                <pre
                  class="hk hl hm hn ho kd ke kf"><span id="2161" class="kg ij dv bk js b ex kh ki r kj">#if MYNEWT_VAL(SPI_0_MASTER) &amp;&amp; MYNEWT_VAL(BME280_OFB)<br/>static struct sensor_itf spi_0_itf_bme = {<br/>    .si_type = SENSOR_ITF_SPI,<br/>    .si_num = 0,<br/>    <strong class="js gy">.si_cs_pin = 3  //  Assumes the CS Pin is connected to PA3.</strong><br/>};<br/>#endif</span></pre>
                <p id="a25d" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">The fix is easy: Just edit the
                  file <code
                    class="dm jp jq jr js b"><a href="https://github.com/apache/mynewt-core/blob/master/hw/sensor/creator/src/sensor_creator.c#L200-L206" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">repos/apache-mynewt-core/hw/sensor/creator/src/sensor_creator.c</a></code>,
                  look for line 200, and <strong class="gi gy">change the CS Pin from 3 to 4</strong>…</p>
                <pre
                  class="hk hl hm hn ho kd ke kf"><span id="c2e0" class="kg ij dv bk js b ex kh ki r kj">#if MYNEWT_VAL(SPI_0_MASTER) &amp;&amp; MYNEWT_VAL(BME280_OFB)<br/>static struct sensor_itf spi_0_itf_bme = {<br/>    .si_type = SENSOR_ITF_SPI,<br/>    .si_num = 0,<br/>    <strong class="js gy">.si_cs_pin = 4 //  Changed to connect CS Pin to PA4.</strong><br/>};<br/>#endif</span></pre>
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i34.png" /></p>
  
  
                  <figcaption><p><em>BME280 connected to Blue Pill</em></p></figcaption>
                </div>
                <p id="d326" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><em class="gh">Tip for
                    Experienced Coders: You might think it’s not proper to modify the Mynewt OS files directly like this
                    (even though it’s </em><a
                    href="https://mynewt.apache.org/latest/tutorials/sensors/sensor_offboard_config.html"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><em class="gh">suggested in this
                      article</em></a><em class="gh">).</em></p>
                <p id="1472" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><em class="gh">The cleaner way to
                    change the configuration is to copy the </em><code
                    class="dm jp jq jr js b"><a href="https://github.com/apache/mynewt-core/blob/master/hw/sensor/creator/src/sensor_creator.c#L453-L489" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><em class="gh">config_bme280_sensor()</em></a></code><a
                    href="https://github.com/apache/mynewt-core/blob/master/hw/sensor/creator/src/sensor_creator.c#L453-L489"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><em class="gh">
                      function</em></a><em class="gh"> into our Application and make the changes there.</em></p>
                <p id="578a" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><a
                    href="https://mynewt.apache.org/latest/tutorials/sensors/sensor_offboard_config.html"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><em class="gh">Check this tutorial
                      for the details</em></a><em class="gh">.</em></p>
              </div>
            </div>
          </section>
          <hr class="gz ew ha hb hc hd he hf hg hh hi" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <h1 id="f0ae" class="ii ij dv bk bj ik il im in io ip iq ir is it iu iv">View Mynewt Debug Messages</h1>
                <p id="2efe" class="gf gg dv bk gi b gj iw gl ix gn iy gp iz gr ja gt">To view debug messages generated
                  by our Application, follow these steps…</p>
                <p id="638e" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">1️⃣ After updating <code
                    class="dm jp jq jr js b">sensor_creator.c</code>, stop the debugger by clicking the <strong
                    class="gi gy">red square</strong> in the debugger toolbar.</p>
                <p id="a34e" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">2️⃣ Click <code
                    class="dm jp jq jr js b"><strong class="gi gy">Terminal → Run Task → [2] Build bluepill_my_sensor</strong></code>
                </p>
                <p id="e2df" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">3️⃣Start the debugger: Click
                  <code class="dm jp jq jr js b"><strong class="gi gy">Debug → Start Debugging</strong></code></p>
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i35.png" /></p>
  
  
              
                </div>
                <p id="ee10" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">4️⃣ Click <code
                    class="dm jp jq jr js b"><strong class="gi gy">View → Output</strong></code></p>
                <div class="figure hk hl hm hn ho cz cl cm paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>


                </div>
                <div class="figure id cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i36.png" /></p>
  
  
                 
                </div>
                <p id="3592" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">5️⃣ In the Output pane that
                  appears, select <code class="dm jp jq jr js b"><strong class="gi gy">Adapter Output</strong></code>
                </p>
                <div class="figure hk hl hm hn ho cz cl cm paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/h0.png" /></p>


              
                </div>
                <div class="figure id cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i37.png" /></p>
  
  
                
                </div>
                <p id="ac2d" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">6️⃣ If we have connected a BME280
                  sensor to our Blue Pill according to the schematic above, we should see the temperature reading like
                  this.</p>
                <p id="3f1a" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Our Application contains a <a
                    href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/apps/my_sensor_app/src/listen_sensor.c#L52-L84"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">listener function</a> that
                  displays the temperature after polling the BME280 sensor. To display a debug message in our
                  Application, we just call <code class="dm jp jq jr js b">console_printf()</code> like this...</p>
                <pre
                  class="hk hl hm hn ho kd ke kf"><span id="adbe" class="kg ij dv bk js b ex kh ki r kj">console_printf(&quot;TMP poll data: tmp &quot;);  <br/>console_printfloat(tmp);  <br/>console_printf(&quot;\n&quot;);</span></pre>
                <p id="7fce" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">But what is this “<code
                    class="dm jp jq jr js b">Adapter Output</code>”? How did we redirect Mynewt’s <code
                    class="dm jp jq jr js b">console_printf()</code> function to show messages in <code
                    class="dm jp jq jr js b">Adapter Output</code>? We used some Arm magic called <a
                    href="https://developer.arm.com/docs/dui0471/k/what-is-semihosting/what-is-semihosting"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">Arm
                      Semihosting</strong></a>.</p>
              </div>
            </div>
          </section>
          <hr class="gz ew ha hb hc hd he hf hg hh hi" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <h1 id="e498" class="ii ij dv bk bj ik il im in io ip iq ir is it iu iv">Customise Mynewt with
                  Semihosting Console</h1>
                <div class="figure hk hl hm hn ho cz dr hp cd hq hr hs ht hu ba hv hw hx hy hz ia paragraph-image">
                
                  <p><img src="https://lupyuen.github.io/images/legacy2/i38.png" /></p>
  
  
                
                  <figcaption><p><em>Arm Semihosting for displaying debug messages.
                    SVC refers to the BKPT instruction. From <a
                      href="https://developer.arm.com/docs/dui0471/k/what-is-semihosting/what-is-semihosting"
                      class="at cg gu gv gw gx" target="_blank"
                      rel="noopener nofollow">https://developer.arm.com/docs/dui0471/k/what-is-semihosting/what-is-semihosting</a>
                  </em></p></figcaption>
                </div>
                <p id="3543" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt"><a
                    href="https://developer.arm.com/docs/dui0471/k/what-is-semihosting/what-is-semihosting"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">Arm Semihosting</a> is a simple
                  way to <strong class="gi gy">display debug messages via ST Link</strong>. When our Application
                  executes the special Arm instruction <code
                    class="dm jp jq jr js b"><a href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/libs/semihosting_console/src/semihosting_console.c#L43-L64" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">bkpt #0xAB</a></code>
                  and passes a debug message, the message is transmitted over ST Link (SWD port) to our computer.</p>
                <p id="3a7a" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">To view the messages, we need to
                  activate the <strong class="gi gy">OpenOCD Console</strong>. This is the <code
                    class="dm jp jq jr js b">Adapter Output</code> log that we saw above. OpenOCD is the program running
                  in the background that connects to Blue Pill via ST Link to flash and debug Blue Pill programs. So it
                  makes sense that the Arm Semihosting debug messages are displayed in the OpenOCD Console.</p>
                <p id="33ff" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">However, <strong
                    class="gi gy">Arm Semihosting is not supported natively in Mynewt</strong>. Mynewt’s <a
                    href="https://mynewt.apache.org/latest/os/modules/console/console.html"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">Console Library</a> routes debug
                  messages to the UART port by default. This makes debugging more complicated: We need to connect Blue
                  Pill’s UART port to our computer via a <a
                    href="https://en.m.wikipedia.org/wiki/FTDI"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">USB Serial Adapter</a> to see the
                  debug messages.</p>
                <p id="c6d6" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Fortunately Mynewt lets us
                  customise the OS by <strong class="gi gy">coding our own Console Library for Arm Semihosting</strong>.
                  The <a
                    href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/tree/master/libs/semihosting_console"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">Semihosting Console Library</a>
                  that’s included in our Application will override the default Console Library and show debug messages
                  in the OpenOCD Console (<code class="dm jp jq jr js b">Adapter Output</code>) instead.</p>
              </div>
            </div>
          </section>
          <hr class="gz ew ha hb hc hd he hf hg hh hi" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <h1 id="9fc4" class="ii ij dv bk bj ik il im in io ip iq ir is it iu iv">Select Mynewt Libraries through
                  Package Dependencies</h1>
                <p id="a539" class="gf gg dv bk gi b gj iw gl ix gn iy gp iz gr ja gt">How do we tell Mynewt to use the
                  Semihosting Console instead of the regular Console Library? Through the Application’s <code
                    class="dm jp jq jr js b"><a href="https://mynewt.apache.org/latest/os/modules/sysinitconfig/sysinitconfig.html" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">pkg.yml</strong></a></code><a
                    href="https://mynewt.apache.org/latest/os/modules/sysinitconfig/sysinitconfig.html"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy"> Package
                      Configuration File</strong></a> located at <code
                    class="dm jp jq jr js b"><a href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/apps/my_sensor_app/pkg.yml" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">apps/my_sensor_app/pkg.yml</a></code>…
                </p>
                <pre
                  class="hk hl hm hn ho kd ke kf"><span id="110c" class="kg ij dv bk js b ex kh ki r kj">pkg.deps:<br/>    - &quot;@apache-mynewt-core/kernel/os&quot;<br/>    - &quot;@apache-mynewt-core/sys/log/stub&quot;<br/>    - &quot;@apache-mynewt-core/sys/stats/stub&quot;<br/>    - &quot;@apache-mynewt-core/hw/sensor&quot;<br/>    - &quot;@apache-mynewt-core/hw/sensor/creator&quot;<br/>    - &quot;@apache-mynewt-core/libc/baselibc&quot;<br/>    - &quot;libs/semihosting_console&quot;</span></pre>
                <p id="d20f" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">In <code
                    class="dm jp jq jr js b">pkg.yml</code> we list the <strong class="gi gy">library packages needed by
                    our Application</strong>. Here we declare the Sensor Library and Sensor Creator, which are needed to
                  support BME280. The last entry <code class="dm jp jq jr js b">libs/semihosting_console</code> is our
                  Semihosting Console Library.</p>
                <p id="8a0c" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">The Semihosting Console Library
                  works only when the <strong class="gi gy">ST Link is connected to our Blue Pill</strong>. (The library
                  hangs when the ST Link is disconnected) When we roll out the Blue Pill in the real world, we should
                  disable the debug console by switching to the <a
                    href="https://mynewt.apache.org/latest/os/modules/console/console.html"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">Stub Console
                      Library</strong></a>. Change the last line of <code class="dm jp jq jr js b">pkg.yml</code> to…
                </p>
                <pre
                  class="hk hl hm hn ho kd ke kf"><span id="fb2d" class="kg ij dv bk js b ex kh ki r kj">    - &quot;@apache-mynewt-core/sys/console/stub&quot;</span></pre>
                <p id="a937" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">To switch back to the default <a
                    href="https://mynewt.apache.org/latest/os/modules/console/console.html"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">UART Console
                      Library</strong></a>, change the last line of <code class="dm jp jq jr js b">pkg.yml</code> to…
                </p>
                <pre
                  class="hk hl hm hn ho kd ke kf"><span id="0379" class="kg ij dv bk js b ex kh ki r kj">    - &quot;@apache-mynewt-core/sys/console/full&quot;</span></pre>
              </div>
            </div>
          </section>
          <hr class="gz ew ha hb hc hd he hf hg hh hi" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <h1 id="c485" class="ii ij dv bk bj ik il im in io ip iq ir is it iu iv">Target Mynewt for multiple
                  microcontrollers</h1>
                <p id="bbd5" class="gf gg dv bk gi b gj iw gl ix gn iy gp iz gr ja gt">In the sections above, we
                  examined Application configuration files that were located in two source folders: <code
                    class="dm jp jq jr js b">my_sensor_app</code> and <code
                    class="dm jp jq jr js b">bluepill_my_sensor</code>. How are <code
                    class="dm jp jq jr js b">my_sensor_app</code> and <code
                    class="dm jp jq jr js b">bluepill_my_sensor</code> related?</p>
                <p id="a550" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Mynewt is a portable operating
                  system that supports many microcontrollers: Blue Pill, STM32F4-Discovery, Arduino Zero, nRF52, … So
                  most of the <strong class="gi gy">Mynewt OS, Bootloader and Application code was designed to be
                    generic</strong> to support different microcontrollers.</p>
                <p id="4cd0" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">In order to compile this generic
                  code to run on Blue Pill, we need to <strong class="gi gy">“Target”</strong> the generic code for Blue
                  Pill. So <code class="dm jp jq jr js b">my_sensor_app</code> is the <strong class="gi gy">generic
                    version</strong> of the Sensor Application, and <code
                    class="dm jp jq jr js b">bluepill_my_sensor</code> is the same application <strong
                    class="gi gy">targeted for Blue Pill</strong>.</p>
                <p id="b4f1" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">How do we target <code
                    class="dm jp jq jr js b">bluepill_my_sensor</code> for Blue Pill? Through the <code
                    class="dm jp jq jr js b"><a href="https://mynewt.apache.org/latest/newt/newt_operation.html" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">target.yml</strong></a></code><a
                    href="https://mynewt.apache.org/latest/newt/newt_operation.html"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy"> Target
                      Configuration File</strong></a> located at <code
                    class="dm jp jq jr js b"><a href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/master/targets/bluepill_my_sensor/target.yml" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">targets/bluepill_my_sensor/target.yml</a></code>…
                </p>
                <pre
                  class="hk hl hm hn ho kd ke kf"><span id="d7bd" class="kg ij dv bk js b ex kh ki r kj">target.app: apps/my_sensor_app<br/>target.bsp: &quot;<a href="http://twitter.com/apache" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">@apache</a>-mynewt-core/hw/bsp/bluepill&quot;<br/>target.build_profile: debug</span></pre>
                <p id="914b" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">The <code
                    class="dm jp jq jr js b">bluepill_my_sensor</code> Target Configuration File states that…</p>
                <p id="4b95" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">1️⃣ <code
                    class="dm jp jq jr js b"><strong class="gi gy">apps/my_sensor_app</strong></code>: Take the generic
                  <code class="dm jp jq jr js b">my_sensor_app</code> Application…</p>
                <p id="89ad" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">2️⃣ <code
                    class="dm jp jq jr js b"><strong class="gi gy">@apache-mynewt-core/hw/bsp/bluepill</strong></code>:
                  And target it for the Blue Pill microcontroller. BSP refers to the Mynewt <a
                    href="https://mynewt.apache.org/latest/os/modules/hal/hal.html"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">Board
                      Support Package</strong></a>, which is a library that contains system functions that are specific
                  to a microcontroller, like Blue Pill.</p>
                <p id="5141" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">3️⃣ <code
                    class="dm jp jq jr js b"><strong class="gi gy">debug</strong></code>: Generate debugger info during
                  compilation</p>
                <p id="64e7" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Mynewt will let us generate
                  Applications for multiple microcontrollers so easily… Just edit the Target Configuration File!</p>
                <p id="7a89" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Here’s the folder structure for
                  our <code class="dm jp jq jr js b">stm32bluepill-mynewt-sensor</code> project. We can see the generic
                  and targeted Applications, as well as their configuration files. All Mynewt projects will follow this
                  structure when we create projects using the <code
                    class="dm jp jq jr js b"><a href="https://mynewt.apache.org/latest/tutorials/blinky/arduino_zero.html" class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow">newt new</a></code><a
                    href="https://mynewt.apache.org/latest/tutorials/blinky/arduino_zero.html"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"> command</a>.</p>
              </div>
            </div>
            <div class="cz">
              <div class="n p">
                <div class="jb jc jd je jf jg ag jh ah ji aj ak">
                  <div class="figure hk hl hm hn ho cz jk jl paragraph-image">
                
                    <p><img src="https://lupyuen.github.io/images/legacy2/i39.png" /></p>
    
    
                    <figcaption><p><em>Mynewt project folder structure</em></p></figcaption>
                  </div>
                </div>
              </div>
            </div>
          </section>
          <hr class="gz ew ha hb hc hd he hf hg hh hi" />
          <section class="cu cv cw cx cy">
            <div class="n p">
              <div class="ac ae af ag ah ds aj ak">
                <h1 id="4b56" class="ii ij dv bk bj ik il im in io ip iq ir is it iu iv">Whats Next?</h1>
                <p id="94a6" class="gf gg dv bk gi b gj iw gl ix gn iy gp iz gr ja gt">Now that we understand the
                  fundamentals of Mynewt’s Sensor Framework, we’ll dive deep in the next tutorial and learn to <strong
                    class="gi gy">send sensor data to an IoT cloud</strong> (like <a
                    href="https://thethings.io/" class="at cg gu gv gw gx"
                    target="_blank" rel="noopener nofollow">thethings.io</a>) via <a
                    href="https://en.wikipedia.org/wiki/ESP8266"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong class="gi gy">ESP8266
                      WiFi</strong></a> and <a
                    href="https://en.wikipedia.org/wiki/Constrained_Application_Protocol"
                    class="at cg gu gv gw gx" target="_blank" rel="noopener nofollow"><strong
                      class="gi gy">CoAP</strong></a>. We’ll be testing WiFi Geolocation — computing your location based
                  on WiFi Access Points scanned by the ESP8266 module.</p>
                <p id="9263" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Check out the latest article on
                  Visual Embedded Rust…</p>
                <div class="mn mo mp mq mr ms"><a rel="noopener"
                    href="https://lupyuen.github.io/articles/visual-embedded-rust-programming-with-visual-studio-code">
                    <section class="mv cl cm ak ce n ar mw mx my mz na nb nc nd ne nf ng nh ni nj nk">
                      <div class="nl n co p nm nn">
                        <h2 class="bj ik no bl dv">
                          <div class="di mt ez fa mu fc">Visual Embedded Rust Programming with Visual Studio Code</div>
                        </h2>
                      </div>
                      <div class="nr r">
                        <div class="ns r nt nu nv nr nw nx ny"></div>
                      </div>
                    </section>
                  </a></div>
                <p id="362e" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Here are the older Mynewt
                  tutorials…</p>
                <div class="mn mo mp mq mr ms"><a rel="noopener"
                    href="https://lupyuen.github.io/articles/connect-stm32-blue-pill-to-esp8266-with-apache-mynewt?source=post_page-----d689b3ca725----------------------">
                    <section class="mv cl cm ak ce n ar mw mx my mz na nb nc nd ne nf ng nh ni nj nk">
                      <div class="nl n co p nm nn">
                        <h2 class="bj ik no bl dv">
                          <div class="di mt ez fa mu fc">Connect STM32 Blue Pill to ESP8266 with Apache Mynewt</div>
                        </h2>
                      </div>
                      <div class="nr r">
                        <div class="nz r nt nu nv nr nw nx ny"></div>
                      </div>
                    </section>
                  </a></div>
                <div class="mn mo mp mq mr ms"><a rel="noopener"
                    href="https://lupyuen.github.io/articles/build-your-iot-sensor-network-stm32-blue-pill-nrf24l01-esp8266-apache-mynewt-thethings-io">
                    <section class="mv cl cm ak ce n ar mw mx my mz na nb nc nd ne nf ng nh ni nj nk">
                      <div class="nl n co p nm nn">
                        <h2 class="bj ik no bl dv">
                          <div class="di mt ez fa mu fc">Build Your IoT Sensor Network — STM32 Blue Pill + nRF24L01 +
                            ESP8266 + Apache Mynewt + thethings.io</div>
                        </h2>
                      </div>
                      <div class="nr r">
                        <div class="oa r nt nu nv nr nw nx ny"></div>
                      </div>
                    </section>
                  </a></div>
                <div class="mn mo mp mq mr ms"><a rel="noopener"
                    href="https://lupyuen.github.io/articles/connect-stm32-blue-pill-to-nb-iot-with-quectel-bc95-g-and-apache-mynewt">
                    <section class="mv cl cm ak ce n ar mw mx my mz na nb nc nd ne nf ng nh ni nj nk">
                      <div class="nl n co p nm nn">
                        <h2 class="bj ik no bl dv">
                          <div class="di mt ez fa mu fc">Connect STM32 Blue Pill to NB-IoT with Quectel BC95-G and
                            Apache Mynewt</div>
                        </h2>
                      </div>
                      <div class="nr r">
                        <div class="ob r nt nu nv nr nw nx ny"></div>
                      </div>
                    </section>
                  </a></div>
                <p id="fffd" class="gf gg dv bk gi b gj gk gl gm gn go gp gq gr gs gt">Here’s the code for this article…
                </p>
                <div class="mn mo mp mq mr ms"><a
                    href="https://github.com/lupyuen/stm32bluepill-mynewt-sensor?source=post_page-----d689b3ca725----------------------"
                    rel="noopener nofollow">
                    <section class="mv cl cm ak ce n ar mw mx my mz na nb nc nd ne nf ng nh ni nj nk">
                      <div class="nl n co p nm nn">
                        <h2 class="bj ik no bl dv">
                          <div class="di mt ez fa mu fc">lupyuen/stm32bluepill-mynewt-sensor</div>
                        </h2>
                      </div>
                      <div class="nr r">
                        <div class="oc r nt nu nv nr nw nx ny"></div>
                      </div>
                    </section>
                  </a></div>
              </div>
            </div>
          </section>
        </div>
      </article>
    </div>
  </div>

  <ul>
    <li>
    <p><a href="https://github.com/sponsors/lupyuen">Sponsor me a coffee</a></p>
    </li>
    <li>
    <p><a href="https://lupyuen.github.io">Check out my articles</a></p>
    </li>
    <li>
    <p><a href="https://lupyuen.github.io/rss.xml">RSS Feed</a></p>
    </li>
  </ul>
    
</body>

</html>
<!--
     FILE ARCHIVED ON 00:12:32 Nov 30, 2019 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 01:30:06 Feb 23, 2021.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  exclusion.robots: 0.265
  captures_list: 134.527
  esindex: 0.01
  CDXLines.iter: 28.183 (3)
  PetaboxLoader3.resolve: 81.898 (4)
  LoadShardBlock: 102.193 (3)
  load_resource: 58.789
  exclusion.robots.policy: 0.254
  PetaboxLoader3.datanode: 42.644 (4)
  RedisCDXSource: 0.619
-->